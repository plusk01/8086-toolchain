<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.77 [en] (Windows NT 5.0; U) [Netscape]">
   <title>Known Tool Problems</title>
</head>
<body>

<h3>
Known Tool Problems</h3>
Below is a list of known problems with the ECEn 425 tools. You will want to watch
out for these so that they don't adversely affect you as you work on your
labs. <b>Please pay special attention to the problems with C86</b>. If
you find new problems, please notify the instructor. 

<br>&nbsp;
<p><b>C86 Compiler</b>
<ul>
<li>C86 does not support the more recent C feature of being able
declare and initialize local variables anywhere in a function body. 
It follows the older C convention. <b>All local variables should
be declared at the beginning of their function and initialized 
separately</b> (except for static local variables, which should be 
initialized where they are declared).
<p>
The error messages the compiler gives when you forget this are a bit 
ambiguous. For example, if I declare a variable <samp>"int i;"</samp> 
in the middle of a function, the compiler simply reports the error 
<samp>"unexpected symbol 'i' found"</samp>.
<p>
For example, instead of
<blockquote><pre>
void MyFunction(void)
{
    Func1();                               <font color=#FF0000>/* BAD! Don't put code before variable declarations. */</font>
    int j;
    .
    .
    for(int i = 0; i < 100; i++) Func2();  <font color=#FF0000>/* BAD! Don't declare i here. */</font>
    char c = 'X';                          <font color=#FF0000>/* BAD! Don't declare c here. */</font>
    .
    .
}
</pre></blockquote>
Write the function like this:
<blockquote>
<pre>
void MyFunction(void)
{
    int j;                             <font color=#009900>/* GOOD! All declarations go here. */</font>
    int i;
    char c;
    
    Func1();                           <font color=#009900>/* GOOD! Start code after declarations. */</font>
    .
    .
    for(i = 0; i < 100; i++) Func2();  <font color=#009900>/* GOOD! Declaration for i not in for(). */</font>
    c = 'X';                           <font color=#009900>/* GOOD! Don't initialize c here. */</font>
    .
    .
}
</pre></blockquote>
<li>
There is a problem with the compiler's register allocation unit that causes
it to use registers improperly when doing complex arithmetic statements.
To avoid problems, break up
statements so that you <b>use only one operator per statement</b>. For example, instead
of</li>
<br><pre>	result = 10 - myVAr / myNum;    <font color=#FF0000>/* BAD!! */</font></pre>
<p>Break it up as:
<p><pre>	result = myVar / myNum;
<br>	result = 10 - result;</pre>

<li> The compiler has a problem with <b>multiple instructions on the
same line</b> (separated by a semicolon).  If you use a macro that
expands to multiple instructions (to keep your code concise), this can
be a problem, particularly if the instructions occur in the body of
the "then" or "else" clause of an "if" statement.  This bug is readily
apparent by studying the flow of control through if-then-else code
blocks as they are generated by the compiler.<p>

<li>
<b>Avoid <tt>long</tt> and <tt>unsigned long</tt></b> variables, except when
absolutely necessary (which is probably never). These are 32-bit operations
and the compiler's support for them is not very reliable. Also, 32-bit
operations can require from a few to very many instructions to complete
because the 8086 doesn't support them directly.<br><br>
If you must use them, avoid mixing long and int types in multiplication and
division operations. For example, instead of<br>
<br>
<pre>	int result;
	long bigNumber;
	...
	result = (int)bigNumber / 3;    <font color=#FF0000>/* BAD!! */</font>
</pre>
Do the following:<br>
<pre>	int result;
	long bigNumber;
	...
	result = (int)bigNumber;
	result = result / 3;
</pre>
</li>
</ul>
<ul>
<li>
<b>Avoid multidimensional arrays</b>.</li>

</ul>
<br><p>


<p><b>NASM</b>
<ul>
<li>None
</ul>
<br><p>

<p><b>Emu86</b>
<ul>
<li>None
</ul>
<br><p>

<hr>
</body>
</html>
